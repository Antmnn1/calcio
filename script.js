const championsData = {
    mondiale: [
        { team: "Francia" },
        { team: "Spagna" },
        { team: "Portogallo" },
        { team: "Francia" },
        { team: "Spagna" },
        { team: "Brasile" },
        { team: "Francia" },
        { team: "Portogallo" },
        { team: "Francia" },
        { team: "Spagna" },
        { team: "Argentina" }
    ],

    europei: [
        { team: "Spagna" },
        { team: "Italia" },
        { team: "Spagna" },
        { team: "Spagna" },
        { team: "Portogallo" },
        { team: "Portogallo" },
        { team: "Portogallo" },
        { team: "Portogallo" },
        { team: "Inghilterra" },
        { team: "Germania" },
        { team: "Francia" }
    ],

    copaamerica: [
        { team: "Brasile" },
        { team: "Argentina" },
        { team: "Brasile" },
        { team: "Brasile" },
        { team: "Ecuador" },
        { team: "Brasile" },
        { team: "Argentina" },
        { team: "Argentina" },
        { team: "Colombia" },
        { team: "Brasile" },
        { team: "Brasile" }
    ],

    intercontinentale: [
        { team: "Juventus" },
        { team: "Arsenal" },
        { team: "Arsenal" },
        { team: "Juventus" },
        { team: "Real Madrid" },
        { team: "Juventus" },
        { team: "Bayern Monaco" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Liverpool" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Bayern Monaco" },
        { team: "Benfica" },
        { team: "Bayern Monaco" },
        { team: "Manchester City" },
        { team: "Barcelona" },
        { team: "PSG" },
        { team: "Juventus" },
        { team: "Manchester United" },
        { team: "Barcelona" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Barcelona" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Liverpool" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "Barcelona" },
        { team: "Barcelona" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Inter" },
        { team: "Atletico de Cali" },
        { team: "Real Madrid" },
        { team: "Inter" },
        { team: "Real Madrid" },
        { team: "Juventus" },
        { team: "Palmeiras" },
        { team: "Inter" },
        { team: "Manchester City" },
        { team: "Inter" },
        { team: "Liverpool" },
        { team: "Barcelona" }
    ],

    champions: [
        { team: "Juventus" },
        { team: "Arsenal" },
        { team: "Arsenal" },
        { team: "Juventus" },
        { team: "Real Madrid" },
        { team: "Juventus" },
        { team: "Bayern Monaco" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Liverpool" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Bayern Monaco" },
        { team: "Benfica" },
        { team: "Bayern Monaco" },
        { team: "Manchester City" },
        { team: "Barcelona" },
        { team: "PSG" },
        { team: "Juventus" },
        { team: "Manchester United" },
        { team: "Barcelona" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Barcelona" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Liverpool" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "Barcelona" },
        { team: "Barcelona" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Inter" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Inter" },
        { team: "Real Madrid" },
        { team: "Juventus" },
        { team: "Bayern Monaco" },
        { team: "Inter" },
        { team: "Manchester City" },
        { team: "Inter" },
        { team: "Liverpool" },
        { team: "Barcelona" }
    ],

    copalibertadores: [
        { team: "Palmeiras" },
        { team: "RB Bragantino" },
        { team: "Racing Club" },
        { team: "Palmeiras" },
        { team: "Boca Juniors" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "Boca Juniors" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "River Plate" },
        { team: "Atletico Nacional" },
        { team: "Flamengo" },
        { team: "Boca Juniors" },
        { team: "Atletico de Cali" },
        { team: "Boca Juniors" },
        { team: "Atletico de Cali" },
        { team: "Boca Juniors" },
        { team: "River Plate" },
        { team: "River Plate" },
        { team: "Corinthians" },
        { team: "River Plate" },
        { team: "Palmeiras" },
        { team: "Flamengo" },
        { team: "Flamengo" },
        { team: "Flamengo" },
        { team: "Palmeiras" },
        { team: "Flamengo" },
        { team: "Palmeiras" },
        { team: "Flamengo" },
        { team: "Atletico de Cali" },
        { team: "Atletico de Cali" },
        { team: "Boca Juniors" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "Atletico de Cali" },
        { team: "Atletico de Cali" },
        { team: "Cruzeiro" },
        { team: "Atletico de Cali" },
        { team: "Cruzeiro" },
        { team: "Palmeiras" },
        { team: "Flamengo" },
        { team: "Palmeiras" },
        { team: "Flamengo" },
        { team: "Palmeiras" },
        { team: "Palmeiras" }
    ],

    premier: [
        { team: "Liverpool" },
        { team: "Arsenal" },
        { team: "Manchester City" },
        { team: "Arsenal" },
        { team: "Everton" },
        { team: "Arsenal" },
        { team: "Liverpool" },
        { team: "Manchester City" },
        { team: "Arsenal" },
        { team: "Arsenal" },
        { team: "Liverpool" },
        { team: "Liverpool" },
        { team: "Arsenal" },
        { team: "Arsenal" },
        { team: "Arsenal" },
        { team: "Arsenal" },
        { team: "Arsenal" },
        { team: "Manchester City" },
        { team: "Everton" },
        { team: "Manchester United" },
        { team: "Arsenal" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Manchester United" },
        { team: "Arsenal" },
        { team: "Manchester City" },
        { team: "Arsenal" },
        { team: "Liverpool" },
        { team: "Brighton" },
        { team: "Tottenham" },
        { team: "Arsenal" },
        { team: "Aston Villa" },
        { team: "Liverpool" },
        { team: "Arsenal" },
        { team: "Manchester City" },
        { team: "Arsenal" },
        { team: "Manchester City" },
        { team: "Crystal Palace" },
        { team: "Liverpool" },
        { team: "Manchester City" },
        { team: "Liverpool" },
        { team: "Aston Villa" },
        { team: "Liverpool" }
    ],

    seriea: [
        { team: "Juventus" },
        { team: "Juventus" },
        { team: "Juventus" },
        { team: "Juventus" },
        { team: "Inter" },
        { team: "Juventus" },
        { team: "Juventus" },
        { team: "Juventus" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Napoli" },
        { team: "Inter" },
        { team: "Roma" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Milan" },
        { team: "Fiorentina" },
        { team: "Inter" },
        { team: "Juventus" },
        { team: "Juventus" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Napoli" },
        { team: "Inter" },
        { team: "Napoli" },
        { team: "Napoli" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Napoli" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Juventus" },
        { team: "Napoli" },
        { team: "Juventus" },
        { team: "Juventus" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Inter" },
        { team: "Napoli" },
        { team: "Napoli" },
        { team: "Juventus" }
    ],

    laliga: [
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Barcelona" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Barcelona" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Athletic Bilbao" },
        { team: "Atletico Madrid" },
        { team: "Barcelona" },
        { team: "Barcelona" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Barcelona" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Barcelona" },
        { team: "Real Madrid" },
        { team: "Barcelona" },
        { team: "Barcelona" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Barcelona" },
        { team: "Barcelona" },
        { team: "Barcelona" },
        { team: "Barcelona" },
        { team: "Barcelona" },
        { team: "Atletico Madrid" },
        { team: "Barcelona" },
        { team: "Real Madrid" },
        { team: "Atletico Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" },
        { team: "Real Madrid" }
    ],

    bundesliga: [
        { team: "Borussia Dortmund" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayer Leverkusen" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayer Leverkusen" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" },
        { team: "Bayern Monaco" }
    ],

    ligue1: [
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "Bordeaux" },
        { team: "Rennes" },
        { team: "Marsiglia" },
        { team: "Bordeaux" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" },
        { team: "PSG" }
    ],

    liganos: [
        { team: "Benfica" },
        { team: "Porto" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Benfica" },
        { team: "Sporting Lisbona" },
        { team: "Porto" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Benfica" },
        { team: "Benfica" },
        { team: "Benfica" },
        { team: "Benfica" },
        { team: "Porto" },
        { team: "Porto" },
        { team: "Porto" },
        { team: "Vitoria Setubal" },
        { team: "Porto" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Benfica" },
        { team: "Sporting Lisbona" },
        { team: "Porto" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Porto" },
        { team: "Porto" },
        { team: "Benfica" },
        { team: "Benfica" },
        { team: "Benfica" },
        { team: "Benfica" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Benfica" },
        { team: "Sporting Lisbona" },
        { team: "Benfica" },
        { team: "Sporting Lisbona" },
        { team: "Benfica" },
        { team: "Sporting Braga" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" },
        { team: "Sporting Lisbona" }
    ],

    eredivisie: [
        { team: "Az Alkmaar" },
        { team: "Ajax" },
        { team: "PSV" },
        { team: "Ajax" },
        { team: "PSV" },
        { team: "PSV" },
        { team: "PSV" },
        { team: "PSV" },
        { team: "Feyenoord" },
        { team: "PSV" },
        { team: "PSV" },
        { team: "PSV" },
        { team: "PSV" },
        { team: "PSV" },
        { team: "Az Alkmaar" },
        { team: "Az Alkmaar" },
        { team: "PSV" },
        { team: "Ajax" },
        { team: "Feyenoord" },
        { team: "Ajax" },
        { team: "Feyenoord" },
        { team: "Feyenoord" },
        { team: "PSV" },
        { team: "Feyenoord" },
        { team: "PSV" },
        { team: "PSV" },
        { team: "Ajax" },
        { team: "PSV" },
        { team: "Feyenoord" },
        { team: "Ajax" },
        { team: "PSV" },
        { team: "Az Alkmaar" },
        { team: "PSV" },
        { team: "PSV" },
        { team: "PSV" },
        { team: "Feyenoord" },
        { team: "PSV" },
        { team: "Az Alkmaar" },
        { team: "Az Alkmaar" },
        { team: "PSV" },
        { team: "Utrecht" },
        { team: "Ajax" },
        { team: "Ajax" },
        { team: "Ajax" },
        { team: "Feyenoord" },
        { team: "Ajax" },
        { team: "Ajax" }
    ],

    argentina: [
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "Godoy Cruz" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "Racing Club" },
        { team: "River Plate" },
        { team: "River Plate" },
        { team: "Boca Juniors" },
        { team: "Racing Club" },
        { team: "River Plate" },
        { team: "Racing Club" },
        { team: "River Plate" },
        { team: "River Plate" },
        { team: "River Plate" },
        { team: "River Plate" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "Rosario Central" },
        { team: "Rosario Central" },
        { team: "Rosario Central" },
        { team: "River Plate" },
        { team: "Racing Club" },
        { team: "Rosario Central" },
        { team: "River Plate" },
        { team: "Boca Juniors" },
        { team: "River Plate" },
        { team: "Independiente" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "Argentinos Juniors" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "River Plate" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "Boca Juniors" },
        { team: "River Plate" },
        { team: "Boca Juniors" },
        { team: "San Lorenzo" },
        { team: "Estudiantes LP" },
        { team: "River Plate" }
    ],

    brasile: [
        { team: "Palmeiras" },
        { team: "RB Bragantino" },
        { team: "Palmeiras" },
        { team: "Cruzeiro" },
        { team: "Flamengo" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "Flamengo" },
        { team: "Flamengo" },
        { team: "Palmeiras" },
        { team: "Flamengo" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "RB Bragantino" },
        { team: "Vasco" },
        { team: "RB Bragantino" },
        { team: "Palmeiras" },
        { team: "Corinthians" },
        { team: "Vasco" },
        { team: "Palmeiras" },
        { team: "Botafogo" },
        { team: "Bahia" },
        { team: "Flamengo" },
        { team: "Sao Paulo" },
        { team: "Palmeiras" },
        { team: "Santos" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "Flamengo" },
        { team: "Flamengo" },
        { team: "Palmeiras" },
        { team: "Cruzeiro" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "Palmeiras" },
        { team: "RB Bragantino" },
        { team: "Palmeiras" },
        { team: "Bahia" },
        { team: "Vitoria" },
        { team: "Palmeiras" },
        { team: "Flamengo" },
        { team: "Palmeiras" },
        { team: "Flamengo" },
        { team: "Flamengo" },
        { team: "Palmeiras" }
    ]

};

// ======================
// CONFIG
// ======================
const leagues = [
    "premier", "seriea", "laliga", "bundesliga", "ligue1", "liganos", "eredivisie", "argentina", "brasile"
];

const nationalCompetitions = ["mondiale", "europei", "copaamerica"];

const isLeague = champ => leagues.includes(champ);
const isNational = champ => nationalCompetitions.includes(champ);

// ======================
// OVERLAY ELEMENTI
// ======================
const overlay = document.getElementById("overlay");
const overlayTitle = document.getElementById("overlayTitle");
const overlayContent = document.getElementById("overlayContent");
const closeBtn = document.getElementById("closeBtn");

// ======================
// CREA PERCORSO STEMMA
// ======================
function getLogoPath(teamName) {
    return "img/" + teamName
        .toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .replace(/\s+/g, "_")
        .replace(/[^\w_]/g, "") + ".png";
}

// ======================
// CLICK COMPETIZIONI
// ======================
document.querySelectorAll(".championship-list li").forEach(item => {
    item.addEventListener("click", () => {
        const champ = item.dataset.champ;
        overlayContent.innerHTML = "";
        overlayTitle.textContent = item.textContent;

        const entries = championsData[champ];
        if (!entries) return;

        const totalSeasons = entries.length;
        const cumulative = {};
        const cumulativeCounts = [];

        for (let i = totalSeasons - 1; i >= 0; i--) {
            const team = entries[i].team;
            cumulative[team] = (cumulative[team] || 0) + 1;
            cumulativeCounts[i] = cumulative[team];
        }

        // ==== STAGIONI ====
        entries.forEach((entry, idx) => {
            const season = totalSeasons - idx - 1;
            const row = document.createElement("div");
            row.className = "winner";
            row.innerHTML = `
                <div>${season}-${season + 1}</div>
                <div class="team-info">
                    <span>${entry.team} (${cumulativeCounts[idx]})</span>
                    <img src="${getLogoPath(entry.team)}" class="team-logo" onerror="this.style.display='none'">
                </div>
            `;
            overlayContent.appendChild(row);
        });

        // ==== CLASSIFICA ====
        const totals = {};
        entries.forEach(e => totals[e.team] = (totals[e.team] || 0) + 1);

        overlayContent.appendChild(document.createElement("hr"));

        Object.entries(totals)
            .sort((a, b) => b[1] - a[1])
            .forEach(([team, wins], idx) => {
                const row = document.createElement("div");
                row.className = isNational(champ) ? "national-row" : "ranking-row";
                row.innerHTML = `
<div class="${isNational(champ) ? 'national-left' : 'ranking-left'}">
    <img src="${getLogoPath(team)}" class="team-logo" onerror="this.style.display='none'">
    <span>${idx + 1}. ${team}</span>
</div>
<div class="${isNational(champ) ? 'national-right' : 'ranking-right'}">${wins}</div>
                `;
                overlayContent.appendChild(row);
            });

        overlay.style.display = "flex";
    });
});

// ======================
// CHIUSURA OVERLAY
// ======================
closeBtn.onclick = () => overlay.style.display = "none";
overlay.onclick = e => { if (e.target === overlay) overlay.style.display = "none"; };

// ======================
// RECAP CLUB E NAZIONALI
// ======================
function generateRecap() {
    const recapContainer = document.getElementById("recapSection");
    const nationalContainer = document.getElementById("nationalRecapSection");
    if (!recapContainer || !nationalContainer) return;

    const clubTotals = {};
    const nationalTotals = {};

    Object.keys(championsData).forEach(comp => {
        championsData[comp].forEach(entry => {
            const team = entry.team;
            if (isNational(comp)) {
                nationalTotals[team] = (nationalTotals[team] || 0) + 1;
            } else {
                if (!clubTotals[team]) clubTotals[team] = { total: 0, leagues: 0, cups: 0 };
                clubTotals[team].total++;
                if (isLeague(comp)) clubTotals[team].leagues++;
                else clubTotals[team].cups++;
            }
        });
    });

    // ==== CLUB RECAP ====
    Object.entries(clubTotals)
        .sort((a, b) => b[1].total - a[1].total)
        .forEach(([team, data], idx) => {
            const row = document.createElement("div");
            row.className = "recap-row";
            row.innerHTML = `
<div class="ranking-left"><span>${idx + 1}. ${team}</span>
<img src="${getLogoPath(team)}" class="team-logo" onerror="this.style.display='none'"></div>
<div class="ranking-right">${data.total} totali (${data.leagues} campionati, ${data.cups} coppe)</div>
            `;
            recapContainer.appendChild(row);
        });

    // ==== NAZIONALI RECAP ====
    Object.entries(nationalTotals)
        .sort((a, b) => b[1] - a[1])
        .forEach(([team, wins], idx) => {
            const row = document.createElement("div");
            row.className = "recap-row";
            row.innerHTML = `
<div class="ranking-left"><span>${idx + 1}. ${team}</span>
<img src="${getLogoPath(team)}" class="team-logo" onerror="this.style.display='none'"></div>
<div class="ranking-right">${wins} titoli</div>
            `;
            nationalContainer.appendChild(row);
        });
}

generateRecap();